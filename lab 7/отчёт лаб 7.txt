Лабораторная работа 7
Выполнила Наумкина Александра 501455 Р3122

Архитектура проекта:

currencies.py - файл с реализацией функции без логгера

logger.py — параметризуемый декоратор для логирования вызовов функций

currencies — получение курсов валют с API ЦБ РФ

square.py — решение квадратного уравнения с логированием

tests.py — тестирование декоратора и функции get_currencies


Детальный разбор компонентов:

1. Декоратор logger (строки 10-55)
Назначение: Универсальный декоратор для логирования выполнения функций.

Ключевые особенности:

Параметризуемость: Может принимать параметр handle для указания места вывода логов

Гибкость вывода: Поддерживает как объекты logging.Logger, так и файловые объекты (по умолчанию sys.stdout)

Информативность: Логирует начало, успешное завершение и ошибки выполнения функций

Сохраняет метаданные: Использует functools.wraps для сохранения имени и документации исходной функции

Принцип работы:

Проверяет тип handle для определения способа вывода

Логирует начало выполнения с параметрами функции

Выполняет оборачиваемую функцию

Логирует результат или ошибку

При ошибке повторно выбрасывает исключение

2. Логирование квадратного уравнения (строки 57-61)

Настройка логгера:

Создается отдельный логгер "QuadraticSolver"

Устанавливается уровень логирования INFO

Используется базовая конфигурация logging.basicConfig для консольного вывода

3. Функция get_currencies (строки 63-122)

Назначение: Получение курсов валют с API Центрального Банка России.

Архитектурные решения:

Валидация входных данных: Проверка типа currency_codes

Обработка ошибок сети: ConnectionError, Timeout, HTTPError

Проверка JSON: Валидация ответа API

Извлечение данных: Поиск валют по кодам с проверкой существования

Проверка типов: Убеждается, что курс валюты - число

Декорирование: Функция использует декоратор @logger(handle=file_logger) для логирования в файл

4. Функция solve_quadratic (строки 124-154)
Назначение: Решение квадратного уравнения вида ax² + bx + c = 0.

Особенности реализации:

Проверка типов: Все коэффициенты должны быть числами

Обработка частных случаев:

a = 0, b = 0: уравнение не существует (ValueError)

a = 0: линейное уравнение

D < 0: нет вещественных корней (возвращает None с warning)

Логирование: Использует quad_logger.warning для отрицательного дискриминанта

Декорирование: Использует декоратор @logger(handle=quad_logger) для логирования в консоль

5. Тестовый блок (строки 156-194)
Структура тестирования:

A. Тестирование get_currencies:

Нормальный случай: Получение курсов USD и EUR

Ошибка данных: Запрос несуществующей валюты 'ZZZ' (ожидается KeyError)

Ошибка сети: Использование неверного URL (ожидается ConnectionError)

B. Тестирование solve_quadratic:

Два корня: (1, 5, 6) → корни -2 и -3

Нет корней: (1, 0, 1) → D < 0 → None

Ошибка типа: ('abc', 1, 1) → TypeError

Некорректное уравнение: (0, 0, 5) → ValueError

